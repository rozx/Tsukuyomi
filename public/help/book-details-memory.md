# 记忆管理

记忆管理功能帮助您记录书籍的关键信息、剧情要点和重要设定，为 AI 翻译提供更丰富的上下文，确保翻译的连贯性和准确性。

## 🧠 什么是记忆

记忆是关于书籍的重要信息片段，用于存储 AI 记忆的大块内容，如背景设定、章节摘要等。

**记忆的用途**：

- 🌍 记录世界观设定和规则
- 📖 保存重要的剧情发展
- 💡 存储关键的背景信息
- ⚠️ 记录翻译时需要注意的事项

## 📋 记忆的结构

每条记忆包含以下信息：

**核心内容**：

- 📝 **内容**: 记忆的详细内容（必填）
- 🤖 **摘要**: AI 自动生成的内容摘要

**关联信息**：

- 🔗 **关联实体**: 记忆可以关联到书籍、角色、术语或章节
- 📅 **创建时间**: 记忆创建的时间
- ⏰ **最后访问时间**: 用于 LRU 缓存策略

## 🚪 访问记忆管理面板

**操作步骤**：

1. 📑 在书籍详情页的左侧边栏
2. ⚙️ 找到"设置菜单"区域
3. 🖱️ 点击"Memory"按钮
4. 📋 右侧会显示记忆管理面板

**面板布局**：

- 🛠️ **顶部工具栏**: 添加记忆、筛选、导入/导出、搜索
- 📇 **记忆列表**: 显示所有记忆的卡片（支持按类型和实体筛选）

- 📄 **记忆详情**: 点击记忆查看和编辑详细内容

## 添加记忆

### 手动添加

**操作步骤**：

1. 在记忆管理面板
2. 点击"添加记忆"按钮
3. 在弹出的对话框中填写：
   - **内容**: 记忆的详细内容（必填）
4. 点击"保存"按钮

**填写建议**：

- **内容详细**: 提供足够的细节帮助 AI 理解
- **一个概念一条记忆**: 每条记忆应该是一个完整的概念
- **长度适中**: 建议控制在 200-500 字

### 记忆内容示例

**世界观设定**：

```
本世界的魔法分为五大元素：火、水、风、土、雷。
每个魔法师只能掌握其中一种元素。
魔法的强度与魔法师的精神力成正比。
```

**剧情要点**：

```
主角在第15章发现自己是失踪多年的王子。
这个秘密只有老管家知道，他一直在暗中保护主角。
```

**翻译注意事项**：

```
本作中"夜明け"不翻译为"黎明"，而应翻译为"曙光"，
因为作者在后记中解释这个词有特殊的象征意义。
```

## 编辑记忆

### 修改记忆内容

**操作步骤**：

1. 在记忆列表中找到要编辑的记忆
2. 点击记忆卡片
3. 在弹出的对话框中修改信息
4. 点击"保存"按钮

**可修改内容**：

- 记忆的内容
- 随时补充和完善记忆

### 更新记忆

**随剧情更新**：

- 新信息揭露时更新内容
- 伏笔实现后添加注释
- 设定扩展时补充细节

## 导入与导出

### 导出记忆

- 点击工具栏的"导出"按钮
- 将当前记忆库导出为 JSON 文件

### 导入记忆

- 点击工具栏的"导入"按钮
- 选择 JSON 格式的记忆文件
- 系统会自动合并新旧记忆

## 删除记忆

**操作步骤**：

1. 在记忆列表中找到要删除的记忆
2. 点击记忆卡片旁的"删除"按钮
3. 在确认对话框中确认删除

**删除影响**：

- 删除后不可恢复
- AI 翻译时不再参考该记忆
- 建议删除前确认不再需要

## 记忆的关联

记忆可以关联到不同类型的实体：

### 关联到书籍

- 适用于全局的世界观设定
- 整本书通用的背景信息
- 翻译风格指南

### 关联到角色

- 角色的重要经历
- 角色的成长变化
- 角色之间的关系发展

### 关联到术语

- 术语的详细解释
- 术语的使用场景
- 术语的翻译注意事项

### 关联到章节

- 章节特定的背景信息
- 章节的剧情要点
- 章节的翻译注意事项

## LRU 缓存策略

记忆系统使用 LRU（最近最少使用）缓存策略：

**工作原理**：

- 每次访问记忆时更新"最后访问时间"
- 系统优先使用最近访问的记忆
- 长时间未使用的记忆优先级降低

**好处**：

- 确保最相关的记忆被优先使用
- 自动管理记忆的优先级
- 避免 Token 超限

## 记忆搜索与筛选

### 筛选功能

**类型筛选**：

- **全部**: 显示所有记忆
- **书籍级**: 显示关联到整本书的记忆
- **角色**: 显示关联到特定角色的记忆
- **术语**: 显示关联到特定术语的记忆
- **章节**: 显示关联到特定章节的记忆

**实体筛选**：

- 选择特定类型后，可以进一步选择具体的实体（如某个角色或章节）
- 快速查看与该实体相关的所有记忆

### 快速搜索

**操作步骤**：

1. 在记忆面板顶部找到搜索框
2. 输入搜索关键词
3. 列表会实时过滤显示匹配的记忆

**搜索范围**：

- 记忆内容
- 摘要

## 记忆在翻译中的应用

### AI 自动应用

**翻译时**：

- AI 会根据章节内容自动选择相关记忆
- 优先使用最近访问的记忆
- 考虑关联实体的匹配度

### 上下文丰富

**记忆的作用**：

- 提供背景信息
- 帮助理解特定术语和概念
- 保持剧情的连贯性
- 指导翻译风格和用词

### 智能选择

**AI 如何选择记忆**：

- 分析章节内容
- 识别关键词和主题
- 匹配相关的记忆
- 根据 LRU 策略排序

## 最佳实践

### 建立记忆库的时机

**推荐流程**：

1. **阅读第一章后**: 记录基本世界观设定
2. **每完成一卷**: 总结重要剧情和设定
3. **翻译前**: 完善关键记忆
4. **翻译中**: 遇到重要信息及时记录

### 记忆的粒度

**避免过细**：

- 不要记录每个细节
- 专注于真正重要的信息
- 一条记忆应该是一个完整的概念

**避免过粗**：

- 不要把太多信息塞在一条记忆中
- 不同主题应该分开记录
- 便于后续查找和使用

**推荐粒度**：

- 一条记忆 = 一个设定/事件/概念
- 长度控制在 200-500 字
- 包含必要的细节，去除无关信息

### 记忆的更新

**定期审核**：

- 每完成一卷审核一次
- 删除过时或无用的记忆
- 补充新的重要信息
- 合并重复的记忆

**保持准确**：

- 及时更新过期信息
- 修正错误的理解
- 补充遗漏的细节

### 记忆与其他功能的配合

**与术语库配合**：

- 术语库记录名词的翻译
- 记忆库解释名词的含义和背景

**与角色设定配合**：

- 角色设定记录人物的基本信息
- 记忆库记录角色的关键经历和发展

**分工建议**：

- 基本信息 → 术语库、角色设定
- 背景故事 → 记忆库
- 翻译规范 → 术语库、记忆库

## 常见问题

### 记忆太多会影响性能吗？

- 系统会智能筛选相关记忆
- 使用 LRU 缓存策略控制记忆数量
- 建议保持在 50-100 条记忆
- 定期清理无用记忆

### 如何组织大量记忆？

1. 合理利用关联功能
2. 保持每条记忆的独立性
3. 使用搜索功能快速查找
4. 定期整理和归档

### 记忆和章节摘要有什么区别？

- **章节摘要**: 自动生成，概括单个章节内容
- **记忆库**: 手动创建，记录跨章节的重要信息

建议：

- 章节摘要用于提供即时上下文
- 记忆库用于记录长期重要信息

### 如何决定什么信息值得记录？

询问自己以下问题：

1. 这个信息在后续章节会被引用吗？
2. 理解这个信息对翻译有帮助吗？
3. 这是一个容易忘记但重要的细节吗？
4. AI 可能会误解或翻译错误吗？

如果任何一个问题的答案是"是"，就值得记录。
