# 发布说明 - v0.6.7

## 版本信息
- **版本号**: 0.6.7
- **发布日期**: 2025年11月27日

---

## 🎉 新功能

### 1. 撤销/重做功能
- **新增撤销/重做系统**：为书籍状态变更提供完整的撤销/重做支持
- **功能特性**：
  - 支持最多 50 条历史记录
  - 自动保存书籍状态变更历史
  - 支持章节和段落管理的撤销/重做
  - 提供操作描述信息，方便用户了解可撤销的操作
- **快捷键**：
  - `Ctrl+Z`：撤销操作
  - `Ctrl+Y`：重做操作
- **技术实现**：新增 `useUndoRedo` composable，提供完整的撤销/重做状态管理

### 2. 键盘快捷键提示面板
- **新增快捷键帮助面板**：通过弹出窗口展示所有可用的键盘快捷键
- **功能特性**：
  - 分类展示快捷键（搜索与替换、编辑操作、段落导航）
  - 美观的快捷键显示界面
  - 可通过工具栏按钮快速访问
- **快捷键分类**：
  - **搜索与替换**：查找、替换、下一个/上一个匹配、关闭搜索工具栏
  - **编辑操作**：撤销、重做、复制所有已翻译文本
  - **段落导航**：上一个/下一个段落、开始编辑当前段落

### 3. 段落翻译管理增强
- **优化翻译处理逻辑**：
  - 改进段落翻译的创建和更新流程
  - 优化增量更新函数，避免重复翻译
  - 增强代码可读性和可维护性
- **组件元素访问改进**：
  - 新增工具函数安全提取 Vue 组件实例的 `$el` 属性
  - 改进类型处理，提升代码可靠性

### 4. 段落导航增强
- **改进段落导航体验**：
  - 增强键盘快捷键支持
  - 添加悬停效果，提升用户交互体验
  - 优化段落间的导航流畅度

---

## 🔧 改进与优化

### 代理服务优化
- **代理映射功能增强**：
  - `addProxyForSite` 方法现在返回布尔值，指示操作是否成功或代理映射是否已存在
  - 新增代理映射时显示成功提示
  - 已存在的映射静默处理，不显示通知
- **代码清理**：
  - 移除不必要的 console.log 语句
  - 优化代码性能和可读性

### 类型安全改进
- **翻译组件类型处理**：
  - 改进 `ParagraphCard.vue` 中翻译组件的类型处理
  - 在访问 `$el` 属性前显式定义组件实例类型
  - 提升代码的类型安全性和可靠性

---

## 🐛 问题修复

### 类型处理修复
- 修复 `ParagraphCard.vue` 中翻译组件的类型处理问题
- 改进组件实例类型转换，确保正确访问 DOM 元素

---

## 📝 技术细节

### 新增文件
- `src/composables/useUndoRedo.ts`：撤销/重做功能的核心实现

### 主要修改文件
- `src/pages/BookDetailsPage.vue`：集成撤销/重做功能、键盘快捷键面板、段落导航增强
- `src/components/novel/ParagraphCard.vue`：改进类型处理和组件元素访问
- `src/components/settings/ProxySettingsTab.vue`：增强代理映射用户反馈
- `src/services/proxy-service.ts`：优化代理映射功能和代码清理
- `src/stores/settings.ts`：更新代理相关状态管理

---

## 🎯 用户体验改进

1. **操作可逆性**：用户现在可以安全地撤销和重做操作，减少误操作带来的影响
2. **快捷键可发现性**：通过快捷键提示面板，用户可以轻松了解所有可用的快捷键
3. **导航流畅性**：改进的段落导航使翻译工作更加高效
4. **反馈及时性**：代理设置操作现在提供更清晰的反馈信息

---

## 📊 统计数据

- **新增功能**: 3 项
- **改进优化**: 2 项
- **问题修复**: 1 项
- **代码变更**: 约 826 行新增，306 行删除

---

## 🔄 升级建议

本次更新主要聚焦于用户体验和功能增强，建议所有用户升级以获得更好的翻译工作体验。特别是撤销/重做功能将显著提升编辑效率。

---

## 📚 相关文档

- 项目架构文档：`AGENTS.md`
- 翻译指南：`docs/TRANSLATION_GUIDE.md`
- 主题指南：`docs/THEME_GUIDE.md`

---

## 🙏 致谢

感谢所有为本次版本做出贡献的开发者。

---

*本文档由自动化工具生成，如有疑问请提交 Issue。*

