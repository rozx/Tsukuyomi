# 发布说明 - v0.7.5

## 版本信息
- **版本号**: 0.7.5
- **发布日期**: 2025年12月13日

---

## 🎉 新功能

### 1. 批量替换翻译工具
- **批量替换功能**：
  - 新增 `batch_replace_translations` 工具，支持批量替换段落翻译
  - 支持根据关键词在原文或翻译文本中查找并替换
  - 支持同时使用原文和翻译关键词进行精确匹配（AND 逻辑）
  - 支持按章节 ID 限制搜索范围，提供更精确的替换控制
  - 支持最大替换数量限制，防止误操作
  - 智能处理完整词汇匹配，避免部分匹配导致的错误替换
- **文档与示例**：
  - 新增 `docs/batch-replace-examples.md` 文档，提供详细的使用示例和场景说明
  - 涵盖多种使用场景：性别替换、专有名词统一、特定段落替换等

### 2. 基于正则表达式的段落搜索
- **高级搜索功能**：
  - 新增 `search_paragraphs_by_regex` 工具，支持使用正则表达式搜索段落
  - 在原文或翻译文本中进行模式匹配搜索
  - 支持按章节 ID 限制搜索范围
  - 提供更灵活和强大的文本查找能力
- **用例支持**：
  - 支持复杂的文本模式查找
  - 便于批量定位需要修改的段落

### 3. 章节导出功能增强
- **导出功能优化**：
  - 增强章节导出功能，改进行处理逻辑
  - 优化导出内容的验证和加载逻辑
  - 提升导出文件的准确性和完整性
  - 改进导出过程中的错误处理和用户反馈

### 4. 翻译进度选项卡界面
- **界面重组**：
  - 在 `TranslationProgress` 组件中实现选项卡界面
  - 将翻译进度、AI 任务历史和待办事项组织到不同选项卡中
  - 优化界面布局和用户体验
  - 提供更清晰的信息组织和访问方式

### 5. 特殊指令选项卡界面
- **指令管理优化**：
  - 在书籍和章节编辑对话框中实现特殊指令的选项卡界面
  - 为翻译、润色、校对任务提供独立的指令编辑选项卡
  - 优化指令编辑的用户体验和交互流程
  - 提供更直观的指令管理界面

### 6. 待办事项管理增强
- **任务创建指南**：
  - 增强待办事项创建功能和详细的任务创建指南
  - 强化多步骤任务的待办事项管理指南
  - 优化批量待办事项创建功能
  - 提升待办事项在翻译进度中的集成度
  - 改进 AI 在处理复杂任务时的任务规划能力

### 7. 任务指令和响应格式指南增强
- **AI 指导优化**：
  - 增强任务指令的清晰度和准确性
  - 优化响应格式指南，确保 AI 输出的结构化程度
  - 改进任务执行的可靠性和一致性

---

## 🔧 改进与优化

### AI 服务优化
- **术语和角色创建流程简化**：
  - 重构翻译和润色服务，简化新术语创建流程
  - 优化术语工具的调用逻辑，减少不必要的交互步骤
  - 改进角色设置的创建和管理流程
- **段落提取逻辑优化**：
  - 改进 `KakuyomuScraper` 中的段落提取逻辑
  - 提升网页内容抓取的准确性和稳定性
  - 优化段落识别的精确度

### 代码重构
- **翻译服务简化**：
  - 大幅简化 `translation-service.ts` 的实现（-693 行，+更清晰的代码结构）
  - 重构润色和校对服务，减少代码复杂度
  - 改进代码组织和可维护性
  - 消除重复代码，遵循 DRY 原则
- **组件优化**：
  - 优化 `SpecialInstructionsPopover` 组件，改进指令管理界面
  - 重构书籍和章节编辑对话框，简化代码结构
  - 改进 `AppRightPanel` 组件，优化消息显示样式

### 测试覆盖增强
- **新增测试套件**：
  - 新增 `paragraph-tools.test.ts` 测试套件，覆盖段落工具的所有功能（+705 行）
  - 新增 `chapter-service.test.ts` 测试套件，验证章节服务功能（+265 行）
  - 增强 `kakuyomu-scraper.test.ts` 测试覆盖
  - 增强 `todo-list-tools.test.ts` 测试覆盖（+108 行）
  - 提升整体测试覆盖率和代码质量保障

---

## 🐛 问题修复

### 导出功能修复
- **章节导出修复**：
  - 修复章节导出验证和内容加载的问题
  - 改进导出过程中的错误处理
  - 确保导出内容的完整性和准确性

### 界面修复
- **消息显示修复**：
  - 修复 `AppRightPanel` 中消息显示的样式问题
  - 改进消息展示的视觉效果和可读性

### 抓取功能修复
- **段落提取修复**：
  - 修复 `KakuyomuScraper` 中段落提取的潜在问题
  - 改进内容抓取的稳定性和准确性

---

## 📝 技术细节

### 主要修改文件
- `src/services/ai/tools/paragraph-tools.ts`：新增批量替换和正则搜索功能，增强段落工具（+1174 行）
- `src/services/ai/tasks/ai-task-helper.ts`：优化任务辅助函数，增强指令和响应格式处理（+379 行）
- `src/services/ai/tasks/translation-service.ts`：大幅简化翻译服务实现（-693 行）
- `src/services/ai/tasks/polish-service.ts`：简化术语创建流程，优化服务逻辑（+351 行，-部分冗余代码）
- `src/services/ai/tasks/proofreading-service.ts`：简化服务实现，优化代码结构（+346 行，-部分冗余代码）
- `src/services/chapter-service.ts`：增强章节导出和搜索功能（+267 行）
- `src/components/novel/TranslationProgress.vue`：实现选项卡界面，集成待办事项管理（+401 行）
- `src/components/dialogs/BookDialog.vue`：实现特殊指令选项卡界面（+171 行，-部分代码）
- `src/components/dialogs/EditChapterDialog.vue`：实现特殊指令选项卡界面（+194 行，-部分代码）
- `src/components/novel/SpecialInstructionsPopover.vue`：优化组件实现（+169 行，-部分代码）
- `src/components/layout/AppRightPanel.vue`：优化消息显示样式（+251 行，-部分代码）
- `src/services/scraper/scrapers/kakuyomu-scraper.ts`：改进段落提取逻辑（+50 行）
- `src/services/ai/tools/character-tools.ts`：简化角色创建流程（+80 行）
- `src/services/ai/tools/terminology-tools.ts`：简化术语创建流程（+80 行）
- `src/services/ai/tools/todo-list-tools.ts`：增强待办事项工具（+114 行）
- `docs/batch-replace-examples.md`：新增批量替换使用文档（+212 行）
- `src/__tests__/paragraph-tools.test.ts`：新增段落工具测试套件（+705 行）
- `src/__tests__/chapter-service.test.ts`：新增章节服务测试套件（+265 行）
- `src/__tests__/todo-list-tools.test.ts`：增强待办事项工具测试（+108 行）

### 新增功能统计
- **新增功能**: 7 项
- **改进优化**: 6 项
- **问题修复**: 3 项
- **代码变更**: 约 4424 行新增，1689 行删除
- **修改文件**: 28 个文件

---

## 🎯 用户体验改进

1. **批量替换功能**：新增的批量替换工具使大规模翻译修正变得更加高效，特别适合统一术语、修正性别、调整语气等批量操作
2. **高级搜索能力**：基于正则表达式的段落搜索提供了更强大的文本查找能力，便于精确定位需要修改的内容
3. **界面组织优化**：选项卡界面的引入使翻译进度和指令管理界面更加清晰和易于导航
4. **工作流简化**：简化的术语和角色创建流程减少了不必要的交互步骤，提升了工作效率
5. **代码质量提升**：大幅简化的服务代码提升了可维护性和可扩展性，为未来功能开发奠定良好基础
6. **测试覆盖增强**：新增的测试套件确保了关键功能的正确性，提升了应用的稳定性和可靠性

---

## 🔄 升级建议

本次更新主要聚焦于：

1. **批量操作能力**：新增的批量替换和正则搜索功能大幅提升了大规模翻译修正的效率，特别适合需要统一术语、调整风格等场景
2. **界面体验优化**：选项卡界面的引入使复杂功能的组织和访问更加直观，提升了用户界面的可用性
3. **工作流优化**：简化的术语和角色创建流程减少了操作步骤，提升了日常翻译工作的效率
4. **代码质量提升**：大幅简化的服务代码不仅提升了可维护性，也为未来功能扩展提供了更好的基础
5. **测试保障增强**：新增的测试套件确保了关键功能的稳定性，特别是批量操作相关的功能

建议所有用户升级以获得更好的使用体验。特别是批量替换功能和界面优化将显著提升大规模翻译工作的效率。

---

## 📚 相关文档

- 项目架构文档：`AGENTS.md`
- 翻译指南：`docs/TRANSLATION_GUIDE.md`
- 主题指南：`docs/THEME_GUIDE.md`
- 批量替换示例：`docs/batch-replace-examples.md`

---

## 🙏 致谢

感谢所有为本次版本做出贡献的开发者。

---

*本文档由自动化工具生成，如有疑问请提交 Issue。*

